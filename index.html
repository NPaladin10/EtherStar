<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Ether Star</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="lib/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="src/main.css">
    <link rel="stylesheet" type="text/css" href="src/star.css">
  </head>
  <body>
    <div id="spinner" class="lds-dual-ring"></div>
    <div id="ui-main" align="center">
      <!--MENU---------------------------------------------->
      <div class="d-flex flex-row m-1" style="z-index:100;position:fixed;">
        <div>
          <a class="btn btn-info btn-sm" data-toggle="collapse" href="#menu-list" role="button">
            <img src="media/md-menu.svg" height="20" width="20">
          </a>
        </div>
        <div>
          <div class="card collapse" id="menu-list" style="width:200px;">
            <div class="card card-body p-1">
              <button type="button" class="btn btn-block btn-info" @click="show='upgrade'" data-toggle="collapse" href="#menu-list">Upgrade</button>
              <button type="button" class="btn btn-block btn-info" @click="show='about'" data-toggle="collapse" href="#menu-list">About</button>
              <button type="button" class="mt-3 btn btn-block btn-danger" @click="reset()" data-toggle="collapse" href="#menu-list">Reset</button>
            </div>
          </div>
        </div>
      </div>
      <!--END MENU---------------------------------------------->
      <!--OVERHEAD---------------------------------------------->
      <div class="overlay p-1 border" style="top:0;">
        <div class="container">
          <div class="row">
            <div class="col" align="left">
              <h2>EtherStar</h2>
            </div>
            <div class="col" align="right">Ξ{{E.toFixed(2)}}</div>
          </div>
        </div>
        <div v-if="!system" v-cloak>
          <div class="container">
            <div class="row">
              <div class="col">System</div>
              <div class="col">Age (min)</div>
              <div class="col">Sites</div>
            </div>
            <div class="row" v-for="b in blocks">
              <div class="link col" @click="id=b.i,options.push('Enter System')">{{b.i}}</div>
              <div class="col">{{(b.dt/60).toFixed()}}</div>
              <div class="col">{{b.tx.length}}</div>
            </div>
          </div>
        </div>
        <div v-if="system" v-cloak>
          <div class="container">
            <div class="row align-items-center">
              <div class="col">{{id}} ({{(aB.dt/60).toFixed()}} min)</div>
              <div class="col">Ξ{{e.toFixed(2)}}</div>
              <div class="col">
                <button type="button" class="btn btn-info" @click="act('Exit System')">Exit System</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id="options" class="p-2 center-div" v-if="options.length>0" v-cloak>
        <button type="button" class="btn btn-block btn-info" v-for="o in options" @click="act(o)">{{o}}</button>
        <div v-if="action=='Harvest'">
          <div>{{pKnown.filter(k=>k==0).length}} @ Ξ0</div>
          <div class="input-group">
            <select class="custom-select" v-model="eid">
              <option v-for="(k,i) in pKnown" v-if="i>0&&k>0" :value="i+1">Ξ{{k}}</option>
            </select>
            <div class="input-group-append">
              <button class="btn btn-outline-success" type="button" @click="act('Harvest Ether')">Harvest</button>
            </div>
          </div>
        </div>
        <button type="button" class="mt-1 btn btn-block btn-info" @click="options=[]">Cancel</button>
      </div>
      <div id="timer" class="p-2 center-div" v-if="time>0" v-cloak>
        <div>{{action}} ({{tStep.toFixed()}}/{{time.toFixed()}}s)</div>
        <div class="progress">
          <div class="progress-bar" role="progressbar" :style="'width:'+(100*tStep/time)+'%'">{{(100*tStep/time).toFixed()}}%</div>
        </div>
        <button type="button" class="mt-1 btn btn-block btn-warning" v-if="time>120" @click="cancelAct()">Cancel</button>
      </div>
      <div id="upgrade" class="p-2 center-div" v-if="show=='upgrade'" v-cloak>
        <h4>Upgrades</h4>
        <div>Upgrade your ship - faster engines, better sensors, efficient harvesters - it is all here!</div>
        <div class="border d-flex justify-content-between align-items-center" v-for="(n,i) in statNames">
          <span class="ml-2">{{n}} ({{ship.stats[i]}})</span>
          <button class="btn btn-outline-success" @click="buyUpgrade(i)" v-if="ship.stats[i]<10" :disabled="upgradeCosts[i]>E">Ξ{{upgradeCosts[i]}} Buy</button>
        </div>
        <button type="button" class="mt-1 btn btn-block btn-info" @click="show=''">Close</button>
      </div>
      <div id="about" class="p-2 center-div" v-if="show=='about'" v-cloak>
        <div>The last Cosmic War Shattered the Known Universe</div>
        <div>An uncountable number systems have been lost </div>
        <div>As threads snap you scour hyperspace for ways </div>
        <div>It's a race against time before the systems are gone</div>
        <div>Thrill seeker, vulture, treasure hunter</div>
        <div>Harvest some cosmic before the thread snaps </div>
        <div>Get in and get out, or be lost forever </div>
        <button type="button" class="mt-1 btn btn-block btn-success" @click="show=''">Play!</button>
      </div>
    </div>
    <div id="map">
      <svg></svg>
    </div>
  </body>
  <script src="lib/ethers-v4.min.js"></script>
  <script src="lib/d3.v5.min.js"></script>
  <script src="lib/d3-delaunay.min.js"></script>
  <script src="lib/vue.2.5.16.min.js"></script>
  <script src="lib/jquery-3.3.1.min.js"></script>
  <script src="lib/popper.1.12.3.min.js"></script>
  <script src="lib/bootstrap.min.js"></script>
  <script type="module" src="src/main.js"></script>
</html>
